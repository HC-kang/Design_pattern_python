## 5장. 프록시 패턴

### 1. 프록시 패턴 개요

> **proxy**  
> 1.명사 대리(위임)  
> 2.명사 대리인  
> 3.명사 격식 또는 전문 용어 (측정·계산하려는 다른 것을 대표하도록 이용하는) 대용물  
> \- 옥스포드 영한사전

사전에서 알 수 있듯, 일반적으로 요청자와 공급자 사이의 중재자, 대리인을 뜻함.  
웹을 예로 들자면, 프록시 서버가 이러한 역할임.

#### 프록시 패턴의 목적

> 사용자 ---- 프록시 서버 ---- 서버 1, 2, 3

위처럼 프록시 서버는 중재자 역할을 하며 사용자의 요청을 분석하여 적당한 서버에 요청을 보내고 결과를 다시 사용자에게 전달하는 형태임. 이 과정에서 자연스럽게 요청을 캡슐화 하기에 안전하고, 분산 시스템 구조에 적합한 아키텍처임.
또한 Proxy Class는 객체(메모리, 파일 등 각종 대상)의 인터페이스 역할을 수행하되 각각 전달하는 객체에 대해 캡슐화를 진행하는 일종의 포장지 역할을 한다고 볼 수 있음.

좀 더 알아보자면

- 복잡한 서비스를 간단한 인터페이스로 표현할 수 있음.
- 캡슐화를 통해 오염을 방지하여, 객체에 대한 높은 보안성을 제공함.
- 다른 서버에 존재하는 외부 객체에 대한 로컬 인터페이스를 제공할수 있음. 쉽게 말하자면, 원격접속을 통해 이미 암호가 해제된 PC에 접속하면, 추가적인 암호 없이도 PC를 다룰 수 있는 것과과 비슷함.
- 자원 사용량이 높은 객체를 다루는 핸들러 역할을 할 수 있음. 지도에서 저화질 이미지를 먼저 보여주고 사용자가 일정시간 대기 할 시 고화질 이미지를 보여주는 것을 예로 들 수 있음.

#### <프록시 패턴 UML 다이어그램>

![proxy_pattern](https://user-images.githubusercontent.com/81678439/158587598-feac670d-a26c-45f3-b2f8-644013638b80.png)

##### 알고리즘 관점

- Proxy
  1. Proxy가 실제 객체에 접근할 수 있는 주소인 레퍼런스를 가지고 있다.
  2. Subject와 동일한 인터페이스 구조를 가져, Proxy는 Subject를 대체할 수 있다.
  3. RealSubject의 생성과 소멸을 담당한다.
- Subject
  1. RealSubject와 Proxy를 책임진다 ...?
  2. Proxy와 RealSubject가 Subject 인터페이스를 구현하기때문에 RealSubject를 Proxy로 대체 할 수 있다
- RealSubject: Proxy가 대체하는 실제 객체를 나타낸다.

##### 자료구조 관점

- Proxy
  1. 내부적으로 RealSubject 클래스의 접근을 제어하고 Client의 요청을 수행.
  2. 클라이언트의 요청을 처리하고 RealSubject를 생성, 소멸시킨다.
- Subject/RealSubject
  1. Subject는 RealSubject와 Proxy를 정의하는 인터페이스임.
  2. 반면 RealSubject는 Subject의 실 구현체임.
- Client
  1. 작업을 수행하기 위해 Proxy에 접근함.

### 2. 프록시의 유형

#### 가상 프록시

- 무거운 객체의 플레이스 홀더 역할
- 클라이언트가 특정 객체를 처음 요청하거나, 접근하였을 때 생성

#### 원격 프록시

- 원격 서버나 다른 주소 공간에 있는 객체에 대한 로컬 인스턴스를 생성하는것.

#### 보호 프록시

- 클라이언트가 본인의 요청에 대한 권한이 있는지를 확인.

#### 스마트 프록시

- 요청에 대한 처리 외에도 추가적인 기능을 수행하는 프록시.

### 3. 프록시 패턴 예제(코드참조)

#### 01_actor.py

- Actor: Server
- Agent: Proxy
- \_\_main\_\_: Client

#### 02_debit_card.py

- You: Client
- Payment: Subject, 추상 클래스
  - do_pay()
- Bank: RealSubject
  - do_pay()
- DebitCard: Proxy
  - do_pay()

### 4. 퍼사드 패턴 vs 프록시 패턴

| 퍼사드 패턴                                                           | 프록시 패턴                                 |
| --------------------------------------------------------------------- | ------------------------------------------- |
| 실객체의 대리 객체를 제공해 접근을 제어.                              | 클래스의 서브시스템에 대한 인터페이스 제공. |
| 타겟 객체와 동일한 인터페이스 구조를 가지고, 타겟에 대한 참조를 지님. | 서브시스템 간 의존도와 통신을 최소화함.     |
| 클라이언트와 감사고있는 객체 사이에서 중재자 역할.                    | 하나로 통합된 간단한 인터페이스 제공.       |
