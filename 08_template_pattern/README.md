## 8장. 템플릿 패턴

### 1. 템플릿 패턴 개요

<img width="521" alt="template" src="https://user-images.githubusercontent.com/81678439/158747423-cd7ff375-525e-4462-b12d-a5bea693ef45.png">

**\<Template>**

- 애플리케이션의 뼈대나 반복되는 알고리즘을 템플릿 메소드에 정의하고, 그 중 일부 단계를 서브클래스화 하여 자유롭게 수정함으로서 다양한 목적을 달성하게 할 수 있는 패턴.
- 템플릿 메소드에 정의되어있는 연산을 원시연산(Primitive Operation)이라고 함.

#### 템플릿 패턴의 예시

| 커피 끓이기                | 차 끓이기                |
| -------------------------- | ------------------------ |
| **1. 물을 끓인다.**        | **1. 물을 끓인다.**      |
| 2. 커피를 **우려낸다.**    | 2. 티백을 **우려낸다.**  |
| 3. 커피를 **컵에 따른다.** | 3. 차를 **컵에 따른다.** |
| 4. 설탕과 우유를 넣는다.   | 4. 레몬을 넣는다         |
| **5. 잘 저어서 섞는다.**   | **5. 잘 저어서 섞는다.** |

#### 템플릿 패턴의 목적

- 알고리즘의 뼈대를 원시연산으로 구현하여 반복사용한다.

- 알고리즘의 전체 구조는 건드리지 않고, 일부 서브클래스만 조정하여 반복사용한다.
- 코드의 중복을 최소화한다.

#### 템플릿 패턴의 장단점

1. 장점

   - 코드의 중복이 없다.
   - 컴포지션이 아닌 상속을 활용하기에, 코드를 재활용 할 수 있고, 일부 함수만 오버라이드 해 주면 된다.
   - 알고리즘의 일부 단계를 서브클래스에서 구현 할 수 있는 유연성을 제공한다.

2. 단점
   - 코드 디버깅이 어렵고, 가독성이 떨어진다. 추상 메소드가 없는 내용에 대해 구상클래스에서 메소드를 (쓸데없이)작성하거나, 추상메소드를 아예 빼먹는 실수를 할 수 있다. 이에따라 예상치 못한 경우를 막기위한 에러 핸들링과 문서화가 필수적이다.
   - 상위, 하위클래스 중 무언가를 수정한다면, 전체 구조와 구현에 영향을 끼칠 수 있어서 유지보수가 어렵다.

#### <템플릿 패턴 UML 다이어그램>

![template_pattern](https://user-images.githubusercontent.com/81678439/158712349-d577e7ba-82eb-494f-95e5-7bfd4607fb33.png)

- AbstractClass: 알고리즘의 각 단계를 정의하는 추상 메서드들로 구성된 인터페이스. 서브클래스가 오버라이드 함.
- ConcreteClass: 각 단계별로, 여러 추상 메서드로 구성된 알고리즘의 서브클래스를 구현한다.
- template_method(): 각 단계별 여러가지 메소드를 호출하는 알고리즘 정의하여 뼈대를 구축한다.

### 2. 템플릿 패턴 예제(코드참조)

#### 01_template.py

- 생략(코드참조)

#### 02_whole.py

- 생략(코드참조)

#### 03_dev_travel.py

- Trip: AbstractClass
  - setTransport(), days(), returnHome(): template_method()
- VeniceTrp, MaldivesTrip: ConcreteClass
- TravelAgency: Client. choice를 통해 여행장소를 선택할 수 있음. 이 결과에 따라 다른 클래스의 인스턴스를 생성하여 반환함.

### 4. 기타

#### 템플릿 메소드 패턴 - 후크

추상 클래스에 정의된 메소드. 일반적으로 기본 구현은 모두 포함되어있고, 여기에서 후크를 통해 서브클래스가 알고리즘의 중간단계를 제어할 수 있는 기능을 제공한다.(02_whole.py 참고)  
예를 들면, 음료 제조 예시에서

**"4-1. 바닐라 시럽을 넣는다."**  
**"5-1. 설탕과 프림을 함께 제공한다."**

라는 간단한 후크를 추가 할 수 있다.

또한 여행사 예제에서도 이와 비슷하게

**"알레르기로 인해 day3의 식사 메뉴를 변경한다"**

와 같은 후크를 사용 할 수 있다.

#### 템플릿 메소드 패턴 - 할리우드 원칙

> 먼저 연락하지 마세요. 저희가 연락 드리겠습니다.

이는 할리우드 영화 제작사들이 배우에게 먼저 연락하는 것에서 유래된 용어라고 함.  
흔히 제어의 역전, 의존성 주입이라고도 불리우고,
hook을 사용하되, 언제나 상위요소가 하위요소의 필요성을 결정한다는 뜻.  
즉, 상위요소(추상클래스)가 하위요소(구상 클래스)에 대한 접근, 필요성을 직접 결정하는 개념.

#### 템플릿 메소드 패턴 - 전략(strategy) 패턴과의 차이점

| 탬플릿 패턴                                     | 전략 패턴       |
| ----------------------------------------------- | --------------- |
| 상속을 활용                                     | 컴포지션을 활용 |
| 서브클래스를 통해 컴파일 단계에서 알고리즘 선택 | 런타임에서 선택 |
