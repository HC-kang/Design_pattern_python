## 2장. 싱글톤 디자인 패턴

### 1. 싱글톤 디자인 패턴 개요

![singleton_pattern](https://user-images.githubusercontent.com/81678439/158121596-4cbf435c-f7c5-4349-8b2a-a431af8f8028.png)  
 싱글톤 패턴의 목적

- **단일객체 생성**
- 전역객체 제공
- 공유된 리소스에 대한 **동시접근** 제어

---

### 2. 싱글톤 디자인패턴 예제(코드참조)

#### 01\_싱글톤 패턴

- '\_\_new\_\_' 함수를 통해 싱글톤 구현

#### 02\_게으른 초기화

- 모듈 임포트 시 객체를 미리 생성하지 않도록(메모리 낭비 최소화) 꼭 필요할 때에 생성.
- 참고사항: 파이썬의 모든 모듈은 싱글톤임.

#### 03\_모노스테이트 싱글톤(Borg)

- '상태를 공유하는 인스턴스의 필요성' by Alex Martelli
- 일반적인 싱글톤과는 달리, 객체를 따로 생성하면 서로 다른 인스턴스가 생성됨
- 그러나 그 모든 인스턴스들이 값을 공유함.
- **Q. 왜 필요하지?** A. subclassing을 통해 서로 다른 객체들이 같은 값을 공유하게 할 수 있음.

#### 04\_모노스테이트 싱글톤(Borg, \_\_new\_\_메소드 이용)

- 생략

#### 05\_메타클래스

- 메타클래스: 클래스 of 클래스
- 이해를 돕기 위해 Calculator, new/init/call 추가
- 동적 클래스를 활용 할 수 있음.
- new: 생성, init: 초기화, call: 인스턴스 실행
- int(4, 5)로 MyInt의 \_\_call\_\_ 메소드 호출, 즉 Int 클래스는 비어있고, 이를 생성 할 때 Int가 아닌 MyInt, 메타클래스가 제어함.

#### 06\_메타싱글톤

- 생략

#### 07\_싱글톤을 사용한 데이터베이서 커넥스 관리

- MetaSingleton의 \_\_call\_\_ 메소드를 사용해 싱글톤을 생성.
- Database 클래스는 MetaSingleton의 메소드 통해서 싱글톤 역할을 할 수 있게 됨.
- 결과적으로 한개의 Database 객체만 생성되는것을 확인 할 수 있음.
- 따라서, 서비스에서 Database에 연결을 요청할 때 마다 매번 객체를 생성하지만, 내부적으로는 매번 같은 객체가 불려지는 모습을 띔.

#### 08\_어플리케이션 헬스 체크

- 관리하고있는 서버목록에서 수정이 발생한 경우, 다른 위치에서 이를 참조하더라도 같은 값을 반환해야 관리상에 문제가 발생하지 않음.
- 이를 위해 \_servers 리스트를 싱글톤으로 생성하여 전역변수처럼 활용함.

---

### 3. 싱글톤 패턴의 단점

- 예기치 못하게 값이 변경되는 상황이 있을 수 있다.
- 하나의 객체에 대해 여러 참조자가 다수 생기고, 이에따라 복잡도와 결합도가 높아질 수 있다.
- 전역변수의 수정이 예기치않게 다른 클래스에도 영향을 줄 수 있다.
